<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografik: förståelse av prislogik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFFFFF;
            color: #101010;
        }
        .header-accent { color: #004731; }
        .subheader-accent { color: #A9A9A9; }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
            margin-bottom: 1.5rem;
            border: 1px solid #D1D5DB; /* Updated border to grey */
        }
        .table-header { background-color: #004731; color: #FFFFFF; }
        .table-cell { padding: 0.75rem; border-bottom: 1px solid #E5E7EB; }
        .flow-arrow {
            display: inline-block;
            margin: 0 0.5rem;
            color: #004731;
            font-weight: bold;
        }
        .product-card {
            border: 1px solid #D1D5DB; /* Updated border to grey */
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
        }
        .product-price-strike { text-decoration: line-through; color: #718096; }
        .product-price-main { font-size: 1.25rem; font-weight: bold; color: #004731; }
        .btn-primary {
            background-color: #E69500;
            color: #FFFFFF;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            display: inline-block;
            text-align: center;
            cursor: pointer;
        }
        .btn-primary:hover {
            background-color: #D48800;
        }
        .highlight-box {
            background-color: #FFF9E6;
            border-left: 4px solid #004731;
            padding: 1rem;
            margin-top: 0.5rem;
            border-radius: 0.25rem;
        }
        .unicode-toggle-off:before { content: '\2610'; font-size: 1.5em; color: #718096; }
        .unicode-toggle-on:before { content: '\2611'; font-size: 1.5em; color: #004731;}
        .unicode-toggle-filled-false:before { content: '\25A3'; font-size: 1.5em; color: #718096; }

        .info-box-primary {
             background-color: #E0F2F1;
             border-color: #B2DFDB;
        }
        .info-box-accent {
            color: #004731;
        }
        .flow-element-bg {
            background-color: #E0F2F1;
            color: #004731;
        }
        .form-select, .form-input, .form-checkbox {
            padding: 0.5rem;
            border-radius: 0.375rem;
            border: 1px solid #D1D5DB;
        }
        .form-label {
            display: block;
            margin-bottom: 0.25rem;
            font-weight: 500;
            color: #374151;
        }
        .price-list-display-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .price-list-card {
            background-color: #F9FAFB;
            border: 1px solid #E5E7EB;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .price-list-card h4 {
            color: #004731;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .price-list-card ul {
            list-style-type: none;
            padding-left: 0;
            font-size: 0.875rem;
        }
        .price-list-card li {
            padding: 0.25rem 0;
            border-bottom: 1px dashed #E5E7EB;
        }
        .price-list-card li:last-child {
            border-bottom: none;
        }
        .filter-option-box {
            background-color: #f0f9ff; /* Light blue */
            border: 1px solid #e0f2fe; /* Lighter blue border */
            padding: 0.75rem;
            border-radius: 0.375rem;
            margin-top: 0.5rem;
        }


        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <section id="introduction" class="mb-12">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-4">Grunderna i prissättning</h2>
                <p class="mb-6 text-gray-700">Denna infografik förklarar hur priser bestäms i vårt system, från kunddata i kundkortet (KUS) till den slutgiltiga prissättningen i både affärssystemet (ERP) och på e-handeln. Att förstå dessa komponenter är avgörande för korrekt prishantering.</p>

                <div class="grid md:grid-cols-3 gap-6 mb-6">
                    <div class="p-4 info-box-primary rounded-lg border">
                        <h3 class="font-semibold text-lg info-box-accent">Prislista (primär)</h3>
                        <p class="text-sm text-gray-600">Kundens huvudprislista. Priser från denna lista har alltid högsta prioritet och tillämpas först.</p>
                    </div>
                    <div class="p-4 info-box-primary rounded-lg border">
                        <h3 class="font-semibold text-lg info-box-accent">Alternativ prislista</h3>
                        <p class="text-sm text-gray-600">Kundens sekundära prislista. Används om en artikel inte återfinns i den primära prislistan.</p>
                        <p class="text-xs text-gray-500 mt-2 pt-1 border-t border-green-100">Viktigt: Detta fält bör alltid vara ifyllt (även om det är samma som primärlistan) då det styr "Ordinarie pris" på e-handeln.</p>
                    </div>
                    <div class="p-4 info-box-primary rounded-lg border">
                        <h3 class="font-semibold text-lg info-box-accent">Ej fallback till listpris</h3>
                        <p class="text-sm text-gray-600 mb-2">Styr om generella listpriser (PL22) får användas om artikeln saknas i kundspecifika listor. Visas som:</p>
                        <div class="flex items-center">
                            <span class="unicode-toggle-on mr-2"></span> <span class="text-xs text-gray-600">Bockad ruta (True): Ingen fallback.</span>
                        </div>
                         <div class="flex items-center mt-1">
                            <span class="unicode-toggle-off mr-2"></span> <span class="text-xs text-gray-600">Tom ruta (False): Fallback tillåten.</span>
                        </div>
                        <div class="flex items-center mt-1">
                            <span class="unicode-toggle-filled-false mr-2"></span> <span class="text-xs text-gray-600">Ruta med rektangel (False): Fallback tillåten.</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2 pt-2 border-t border-green-100">Notera: Både en tom ruta (☐) och en ruta med rektangel (▣) indikerar 'Ej bockad' (False) och tillåter fallback.</p>
                    </div>
                </div>

                <h3 class="text-xl font-semibold subheader-accent mb-3">Prioriteringsordning för pris:</h3>
                <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <span class="font-medium p-2 flow-element-bg rounded-md">Prislista (Primär)</span>
                    <span class="flow-arrow">&rarr;</span>
                    <span class="font-medium p-2 flow-element-bg rounded-md">Alternativ Prislista</span>
                    <span class="flow-arrow">&rarr;</span>
                    <span class="font-medium p-2 flow-element-bg rounded-md">PL22/Listpris <small>(om tillåtet)</small></span>
                </div>
            </div>
        </section>

        <section id="core-rules" class="mb-12">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-4">Kärnregler för pris</h2>
                <p class="mb-6 text-gray-700">Några viktiga regler styr hur priser appliceras och är fundamentala för att förstå systemets beteende.</p>
                <div class="space-y-6">
                    <div class="p-4 border rounded-lg border-yellow-300 bg-yellow-50"> <h3 class="text-lg font-semibold text-yellow-700">Regel 1: primär prislista styr alltid</h3>
                        <p class="text-gray-600 mt-1">Pris från kundens 'Prislista' (primär) används alltid om artikeln finns där, även om ett lägre pris existerar i 'Alternativ prislista'.</p>
                        <div class="highlight-box text-sm">
                            <strong>Exempel:</strong> Artikel X finns i PL3001 för 150kr och i PL3000 för 100kr. Om PL3001 är kundens primära prislista blir kundpriset 150kr.
                        </div>
                    </div>
                    <div class="p-4 border rounded-lg border-yellow-300 bg-yellow-50">
                        <h3 class="text-lg font-semibold text-yellow-700">Regel 2: "ej fallback till listpris"-inställningen</h3>
                        <p class="text-gray-600 mt-1">Denna inställning på kundkortet avgör om systemet får hämta priser från den generella listan (PL22) när en artikel saknas i kundens primära och alternativa prislistor.</p>
                        <ul class="list-disc list-inside mt-2 text-sm text-gray-600 pl-2 space-y-1">
                            <li><strong>Bockad (TRUE):</strong> Ingen fallback till PL22. Kunden kan endast köpa artiklar som finns i deras primära eller alternativa prislista. För artiklar utanför dessa, ställer ERP-systemet en fråga om orderläggning ändå.</li>
                            <li><strong>Ej bockad (FALSE):</strong> Fallback till PL22 tillåts. Om en artikel inte finns i kundens specifika prislistor, hämtas pris från PL22. Detta gäller oavsett om rutan visas som tom (☐) eller med en ifylld rektangel (▣) i systemet.</li>
                        </ul>
                    </div>
                    <div class="p-4 border rounded-lg border-green-300 bg-green-50">
                        <h3 class="text-lg font-semibold text-green-700">Viktig notering: alternativ prislista</h3>
                        <p class="text-gray-600 mt-1">Fältet "Alternativ prislista" på kundkortet (KUS) måste alltid vara ifyllt, även om det skulle vara samma prislista som den primära. Detta fält används för att bestämma "Ordinarie pris" som visas på e-handeln, vilket är avgörande för att kunden ska kunna se eventuella rabatter eller avtalspriser korrekt.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="erp-scenarios" class="mb-12">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-2">Prissättning i affärssystemet (ERP)</h2>
                <p class="mb-6 text-gray-700">Så här kan en order se ut i affärssystemet (Jeeves) beroende på fallback-inställningen. Vi utgår från att kunden har PL3001 som "Prislista" och PL3000 som "Alternativ prislista".</p>

                <div class="mb-8">
                    <h3 class="text-xl font-semibold subheader-accent mb-3">Scenario A: "ej fallback till listpris" = TRUE (ingen fallback)</h3>
                    <p class="text-sm text-gray-600 mb-3">När fallback inte är tillåten (indikeras med <span class="unicode-toggle-on"></span> i systemet), begränsas prissättningen strikt till kundens avtalade prislistor.</p>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left">
                            <thead class="table-header">
                                <tr>
                                    <th class="table-cell">Art.nr</th>
                                    <th class="table-cell">Priskälla</th>
                                    <th class="table-cell">Pris/st</th>
                                    <th class="table-cell">Kommentar</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-medium">194101</td>
                                    <td class="table-cell">PL3001</td>
                                    <td class="table-cell">100kr</td>
                                    <td class="table-cell">Pris från primär prislista.</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">151009</td>
                                    <td class="table-cell">PL3001</td>
                                    <td class="table-cell">150kr</td>
                                    <td class="table-cell">Primär prislista styr (trots 100kr i PL3000).</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">170041</td>
                                    <td class="table-cell">PL3000</td>
                                    <td class="table-cell">200kr</td>
                                    <td class="table-cell">Pris från alternativ prislista.</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">640003</td>
                                    <td class="table-cell">-</td>
                                    <td class="table-cell">-</td>
                                    <td class="table-cell">Saknas i prislistor. ERP frågar: "Order ändå?".</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="highlight-box text-sm mt-3">
                        <strong>Nyckelinsikt:</strong> Artiklar utanför kundens avtalade prislistor kräver manuell hantering eller blockeras om fallback inte är tillåten.
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-semibold subheader-accent mb-3">Scenario B: "ej fallback till listpris" = FALSE (fallback tillåten)</h3>
                     <p class="text-sm text-gray-600 mb-3">När fallback är tillåten (indikeras med <span class="unicode-toggle-off"></span> eller <span class="unicode-toggle-filled-false"></span> i systemet), kan systemet hämta priser från den generella listpriset (PL22) om artikeln saknas i kundspecifika listor.</p>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm text-left">
                            <thead class="table-header">
                                <tr>
                                    <th class="table-cell">Art.nr</th>
                                    <th class="table-cell">Priskälla</th>
                                    <th class="table-cell">Pris/st</th>
                                    <th class="table-cell">Kommentar</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-medium">194101</td>
                                    <td class="table-cell">PL3001</td>
                                    <td class="table-cell">100kr</td>
                                    <td class="table-cell">Pris från primär prislista.</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">151009</td>
                                    <td class="table-cell">PL3001</td>
                                    <td class="table-cell">150kr</td>
                                    <td class="table-cell">Primär prislista styr.</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">170041</td>
                                    <td class="table-cell">PL3000</td>
                                    <td class="table-cell">200kr</td>
                                    <td class="table-cell">Pris från alternativ prislista.</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-medium">640003</td>
                                    <td class="table-cell">PL22</td>
                                    <td class="table-cell">300kr</td>
                                    <td class="table-cell">Pris från PL22 (fallback).</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                     <div class="highlight-box text-sm mt-3">
                        <strong>Nyckelinsikt:</strong> PL22 fungerar som ett skyddsnät för prissättning, vilket säkerställer att artiklar utanför specifika avtal ändå får ett pris.
                    </div>
                </div>
            </div>
        </section>

        <section id="interactive-demo" class="mb-12">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-4">Interaktiv demo: testa prislogiken</h2>
                
                <h3 class="text-xl font-semibold subheader-accent mb-3">Välj kunduppsättning (KUS):</h3>
                <div class="grid md:grid-cols-3 gap-6 mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50">
                    <div>
                        <label for="primaryPriceList" class="form-label">Primär Prislista:</label>
                        <select id="primaryPriceList" class="form-select w-full"></select>
                    </div>
                    <div>
                        <label for="alternativePriceList" class="form-label">Alternativ Prislista:</label>
                        <select id="alternativePriceList" class="form-select w-full"></select>
                    </div>
                    <div class="flex items-center mt-4 md:mt-6">
                        <input type="checkbox" id="noFallback" class="form-checkbox h-5 w-5 text-green-600">
                        <label for="noFallback" class="ml-2 text-sm text-gray-700">Ej fallback till listpris (PL22)</label>
                    </div>
                </div>

                <h3 class="text-xl font-semibold subheader-accent mb-3">Orderläggning (Order1):</h3>
                <div class="grid md:grid-cols-2 gap-6 mb-6 items-end">
                    <div>
                        <label for="articleNumber" class="form-label">Artikelnummer:</label>
                        <input type="text" id="articleNumber" class="form-input w-full" placeholder="Skriv in art.nr.">
                    </div>
                    <div>
                        <button id="lookupPriceBtn" class="btn-primary w-full md:w-auto">Lägg order</button>
                    </div>
                </div>

                <div class="mt-6 mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50">
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">Resultat:</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <p class="text-sm"><strong>Pris:</strong> <span id="calculatedPrice" class="font-bold text-green-700">-</span></p>
                        <p class="text-sm"><strong>Pris från:</strong> <span id="priceSource" class="font-bold text-gray-600">-</span></p>
                    </div>
                    <p id="systemMessage" class="text-sm text-red-600 mt-3 italic"></p>
                </div>
                <div class="mb-6">
                    <h3 class="text-xl font-semibold subheader-accent mb-3">Tillgängliga prislistor & artiklar (PRH):</h3>
                    <div id="priceListDisplay" class="price-list-display-container">
                    </div>
                </div>
            </div>
        </section>

        <section id="ecommerce-logic" class="mb-12">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-4">Prislogik på e-handeln</h2>
                <p class="mb-4 text-gray-700">På e-handeln tillämpas samma grundläggande prislogik som i ERP-systemet. Det finns dock specifika aspekter kring hur artiklar visas och hur "Ordinarie pris" hanteras för att ge kunden en tydlig överblick.</p>

                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                        <h3 class="font-semibold text-lg text-green-700">Ditt pris (försäljningspris)</h3>
                        <p class="text-sm text-gray-600">Det faktiska priset kunden betalar. Bestäms enligt prioriteringsordningen:</p>
                        <ol class="list-decimal list-inside text-sm text-gray-600 mt-1 pl-2">
                            <li>Prislista (Primär)</li>
                            <li>Alternativ Prislista</li>
                            <li>PL22/Listpris (om "Ej fallback" är FALSE på KUS)</li>
                        </ol>
                    </div>
                    <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                         <h3 class="font-semibold text-lg text-yellow-700">Ordinarie pris (rek. pris)</h3>
                        <p class="text-sm text-gray-600">Visas ofta överstruket för jämförelse. Detta pris hämtas från kundens <strong>Alternativa prislista</strong>. Det är därför kritiskt att fältet "Alternativ prislista" alltid är ifyllt på kundkortet (KUS), även om det är samma som den primära prislistan. Om artikeln saknas i den alternativa listan, kan PL22 användas som källa för "Ordinarie pris", beroende på systemkonfiguration.</p>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-xl font-semibold subheader-accent mb-3">Artikelvisning och filter på e-handeln:</h3>
                    <p class="text-gray-700 mb-2">För att ge kunden en relevant upplevelse visas artiklar enligt följande:</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 pl-2 space-y-1 mb-3">
                        <li>Kunden ser i grunden endast de artiklar som finns med i deras primära "Prislista" eller deras "Alternativa prislista". Detta säkerställer att kunden primärt exponeras för det sortiment de har avtalade priser på.</li>
                        <li>Om kunden har inställningen "Ej fallback till listpris" = FALSE (d.v.s. fallback till PL22 är tillåtet), ges kunden vanligtvis ett filteralternativ på e-handelssidan:
                            <div class="filter-option-box text-xs">
                                <p class="font-medium">Exempel på filter:</p>
                                <label class="flex items-center mt-1"><input type="radio" name="ecomFilter" class="form-checkbox h-4 w-4 mr-1" checked> Visa mitt avtalssortiment (artiklar från primär prislista)</label>
                                <label class="flex items-center mt-1"><input type="radio" name="ecomFilter" class="form-checkbox h-4 w-4 mr-1"> Visa alla artiklar (inkl. PL22-priser)</label>
                            </div>
                        </li>
                        <li>Om "Ej fallback till listpris" = TRUE, visas inga artiklar från PL22, och filteralternativet för att inkludera dem är inte tillgängligt.</li>
                    </ul>
                     <div class="highlight-box text-sm">
                        <strong>Nyckelinsikt för e-handel:</strong> Artikelvisningen anpassas för att matcha kundens prisavtal, med möjlighet att bredda urvalet om fallback tillåts. Korrekt ifylld "Alternativ prislista" är avgörande för visning av "Ordinarie pris".
                    </div>
                </div>


                <h3 class="text-xl font-semibold subheader-accent mb-4">Visuella exempel på e-handeln</h3>
                <p class="text-sm text-gray-600 mb-4">Baserat på en kund med "Ej fallback till listpris" = FALSE (visas som <span class="unicode-toggle-off"></span> eller <span class="unicode-toggle-filled-false"></span>), Primär: PL3001, Alternativ: PL3000.</p>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="product-card">
                        <div class="w-full h-32 bg-gray-200 rounded mb-3 flex items-center justify-center text-gray-400">Bildmockup</div>
                        <h4 class="font-semibold mb-1">Artikel 151009</h4>
                        <p class="text-sm mb-1 product-price-strike">Ordinarie pris: 100kr</p>
                        <p class="mb-2 product-price-main">Ditt pris: 150kr</p>
                        <button class="btn-primary text-sm w-full">Köp</button>
                        <p class="text-xs text-gray-500 mt-2">Primär prislista (150kr) styr "Ditt pris", alternativ prislista (100kr) visas som "Ordinarie".</p>
                    </div>
                     <div class="product-card">
                        <div class="w-full h-32 bg-gray-200 rounded mb-3 flex items-center justify-center text-gray-400">Bildmockup</div>
                        <h4 class="font-semibold mb-1">Artikel 170041</h4>
                        <p class="text-sm mb-1 product-price-strike">Ordinarie pris: 200kr</p>
                        <p class="mb-2 product-price-main">Ditt pris: 200kr</p>
                        <button class="btn-primary text-sm w-full">Köp</button>
                        <p class="text-xs text-gray-500 mt-2">"Ditt pris" från alternativ prislista då den saknas i primär. "Ordinarie pris" är samma.</p>
                    </div>
                    <div class="product-card">
                        <div class="w-full h-32 bg-gray-200 rounded mb-3 flex items-center justify-center text-gray-400">Bildmockup</div>
                        <h4 class="font-semibold mb-1">Artikel 640003</h4>
                        <p class="text-sm mb-1 product-price-strike">Ordinarie pris: 300kr</p>
                        <p class="mb-2 product-price-main">Ditt pris: 300kr</p>
                        <button class="btn-primary text-sm w-full">Köp</button>
                        <p class="text-xs text-gray-500 mt-2">Fallback till PL22 för både "Ditt pris" och "Ordinarie pris".</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="summary">
            <div class="card">
                <h2 class="text-2xl font-semibold header-accent mb-4">Sammanfattning: centrala aspekter av prislogiken</h2>
                <p class="mb-6 text-gray-700">Denna prislogik bygger på en hierarkisk struktur för att fastställa priser. Förståelsen av dess komponenter och regler är viktig för att kunna förutse systemets prissättningsbeteende.</p>
                <ul class="list-none space-y-3">
                    <li class="flex items-start">
                        <span class="text-green-600 mr-2">&#9679;</span> <p class="text-gray-700"><strong>Prioritetsordning:</strong> Priser hämtas i första hand från den primära prislistan, därefter den alternativa, och slutligen från listpris (PL22) om fallback är aktiverat.</p>
                    </li>
                    <li class="flex items-start">
                        <span class="text-green-600 mr-2">&#9679;</span>
                        <p class="text-gray-700"><strong>Primärlistans dominans:</strong> Ett pris i den primära prislistan åsidosätter alltid priser i den alternativa listan för samma artikel, oavsett prisskillnad.</p>
                    </li>
                    <li class="flex items-start">
                        <span class="text-green-600 mr-2">&#9679;</span>
                        <p class="text-gray-700"><strong>Fallback-styrning:</strong> Inställningen "Ej fallback till listpris" (visad som <span class="unicode-toggle-on"></span>, <span class="unicode-toggle-off"></span>, eller <span class="unicode-toggle-filled-false"></span>) avgör om PL22 kan användas när en artikel saknas i kundspecifika listor.</p>
                    </li>
                     <li class="flex items-start">
                        <span class="text-green-600 mr-2">&#9679;</span>
                        <p class="text-gray-700"><strong>E-handelns prisvisning:</strong> "Ditt pris" följer den generella logiken. "Ordinarie pris" hämtas från den alternativa prislistan (som därför alltid måste vara ifylld på KUS). Artikelvisning kan filtreras baserat på kundens avtal och fallback-status.</p>
                    </li>
                </ul>
            </div>
        </section>

        <footer class="text-center mt-12 mb-6">
            <p class="text-sm text-gray-500">&copy; <span id="currentYear"></span> Ert Företagsnamn. Alla rättigheter förbehållna.</p>
        </footer>
    </div>
    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        const allPriceLists = {
            "PL3000": { name: "Prislista 3000", articles: { "151009": 100, "170041": 200 } },
            "PL3001": { name: "Prislista 3001", articles: { "194101": 100, "151009": 150 } },
            "PL22":   { name: "PL22 / Listpris", articles: { "170041": 220, "640003": 300, "194101": 120, "151009": 160, "990001": 50, "990002": 75, "880003": 460 } },
            "PL4000": { name: "Prislista 4000", articles: { "194101": 90, "990001": 45, "880001": 250, "151009": 110 } },
            "PL4001": { name: "Prislista 4001", articles: { "151009": 140, "990002": 70, "880002": 350, "170041": 210 } },
            "PL5000": { name: "Prislista 5000", articles: { "170041": 190, "640003": 290, "880001": 240, "880003": 450, "194101": 105 } },
            "PL5001": { name: "Prislista 5001", articles: { "194101": 110, "990001": 55, "880002": 340, "880003": 440, "640003": 305 } }
        };

        const primaryPriceListSelect = document.getElementById('primaryPriceList');
        const alternativePriceListSelect = document.getElementById('alternativePriceList');
        const noFallbackCheckbox = document.getElementById('noFallback');
        const articleNumberInput = document.getElementById('articleNumber');
        const lookupPriceBtn = document.getElementById('lookupPriceBtn');
        const calculatedPriceSpan = document.getElementById('calculatedPrice');
        const priceSourceSpan = document.getElementById('priceSource');
        const systemMessageP = document.getElementById('systemMessage');
        const priceListDisplayDiv = document.getElementById('priceListDisplay');

        function populatePriceListDisplay() {
            priceListDisplayDiv.innerHTML = ''; 
            for (const listKey in allPriceLists) {
                const listData = allPriceLists[listKey];
                const card = document.createElement('div');
                card.className = 'price-list-card';
                
                const title = document.createElement('h4');
                title.textContent = listData.name; 
                card.appendChild(title);
                
                const ul = document.createElement('ul');
                if (Object.keys(listData.articles).length > 0) {
                    for (const artNr in listData.articles) {
                        const li = document.createElement('li');
                        li.textContent = `Art. ${artNr}: ${listData.articles[artNr]}kr`;
                        ul.appendChild(li);
                    }
                } else {
                    const li = document.createElement('li');
                    li.textContent = 'Inga artiklar i denna lista.';
                    ul.appendChild(li);
                }
                card.appendChild(ul);
                priceListDisplayDiv.appendChild(card);
            }
        }


        function populateDropdowns() {
            const defaultOptionText = "Välj prislista...";
            
            function createDefaultOption() {
                const option = document.createElement('option');
                option.value = "";
                option.textContent = defaultOptionText;
                return option;
            }

            primaryPriceListSelect.appendChild(createDefaultOption());
            alternativePriceListSelect.appendChild(createDefaultOption().cloneNode(true));

            for (const key in allPriceLists) {
                const option1 = document.createElement('option');
                option1.value = key;
                option1.textContent = allPriceLists[key].name; 
                primaryPriceListSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = key;
                option2.textContent = allPriceLists[key].name; 
                alternativePriceListSelect.appendChild(option2);
            }
        }

        function handlePriceLookup() {
            const primaryKey = primaryPriceListSelect.value;
            const alternativeKey = alternativePriceListSelect.value;
            const noFallback = noFallbackCheckbox.checked;
            const articleNumber = articleNumberInput.value.trim();

            calculatedPriceSpan.textContent = '-';
            priceSourceSpan.textContent = '-';
            systemMessageP.textContent = '';

            if (!articleNumber) {
                systemMessageP.textContent = 'Vänligen ange ett artikelnummer.';
                return;
            }
            if (!primaryKey) {
                 systemMessageP.textContent = 'Vänligen välj en primär prislista.';
                return;
            }


            let price = null;
            let source = null;

            const primaryList = allPriceLists[primaryKey];
            const alternativeList = allPriceLists[alternativeKey]; 
            const pl22List = allPriceLists["PL22"];

            if (primaryList && primaryList.articles.hasOwnProperty(articleNumber)) {
                price = primaryList.articles[articleNumber];
                source = primaryList.name;
            } 
            else if (alternativeKey && allPriceLists[alternativeKey] && allPriceLists[alternativeKey].articles.hasOwnProperty(articleNumber)) { 
                price = allPriceLists[alternativeKey].articles[articleNumber];
                source = allPriceLists[alternativeKey].name;
            }
            else if (noFallback) {
                systemMessageP.textContent = 'Artikeln ingår ej i kundens valda prislistor. Orderläggning skulle kräva manuell åtgärd i ERP.';
            }
            else {
                if (pl22List && pl22List.articles.hasOwnProperty(articleNumber)) {
                    price = pl22List.articles[articleNumber];
                    source = pl22List.name;
                } else {
                    systemMessageP.textContent = 'Artikelnummer hittades inte i någon tillämplig prislista.';
                }
            }

            if (price !== null && source !== null) {
                calculatedPriceSpan.textContent = `${price}kr`;
                priceSourceSpan.textContent = source;
            }
        }

        lookupPriceBtn.addEventListener('click', handlePriceLookup);
        
        populatePriceListDisplay();
        populateDropdowns();

    </script>
</body>
</html>
